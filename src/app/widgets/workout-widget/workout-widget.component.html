<app-widget [widgetData]="getWidgetData()" [isWidgetLoaded]="isWidgetLoaded"
  (refreshWidgetAction)="this.refreshWidget()">
  <ng-template #header>
    <div class="header">
      <mat-icon>fitness_center</mat-icon>
      <div>Workout</div>
    </div>
  </ng-template>

  <ng-template #body>
    <div [ngSwitch]="WIDGET_VIEW">
      <div *ngSwitchCase="widgetViewEnum.WORKOUT_SESSIONS_LIST_VIEW">
        <div class="space-y-2">
          <h2>Sessions</h2>

          <div class="flex flex-row flex-wrap space-x-1 space-y-0.5">
            <button *ngFor="let workoutMonth of this.workoutMonths" class="workout-month"
              [color]="this.isSelectedMonth(workoutMonth) ? 'primary' : ''" (click)="this.selectMonth(workoutMonth)"
              mat-raised-button>
              {{formatWorkoutDateMonth(workoutMonth) }} </button>
          </div>

          <div id="workout-sessions-grid">
            <span class="workout-session" *ngFor="let workoutSession of this.workoutSessions"
              (click)="editWorkoutSession(workoutSession)">{{ workoutSession.workoutDate | dateFormat:'short' }}
            </span>
          </div>

          <h4>Créer une session</h4>
          <mat-form-field id="workoutDatePickerField" appearance="fill">
            <mat-label>Sélectionnez la date</mat-label>
            <input [formControl]="workoutDateFormControl" matInput [matDatepicker]="workoutDatePicker" />
            <mat-hint>{{ dateFormat }}</mat-hint>
            <mat-datepicker-toggle matSuffix [for]="workoutDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #workoutDatePicker></mat-datepicker>
          </mat-form-field>

          <button mat-raised-button id="createWorkoutSessionButton" (click)="createWorkoutSession()" color="primary">
            Créer
          </button>
        </div>

        <div *ngIf="this.workoutStatsByWeek.length">
          <div>Cette semaine :</div>
          <div *ngFor="let workoutStat of this.workoutStatsByWeek">
            <span>{{workoutStat.workoutTypeName}} : {{workoutStat.totalNumberOfReps}}</span>
          </div>
        </div>

        <div *ngIf="this.workoutStatsByMonth.length">
          <div>Ce mois-ci</div>
          <div *ngFor="let workoutStat of this.workoutStatsByMonth">
            <span>{{workoutStat.workoutTypeName}} : {{workoutStat.totalNumberOfReps}}</span>
          </div>
        </div>

        <h2>Types d'exercices</h2>
        <div id="workout-types-grid">
          <span class="workoutTypeName" *ngFor="let workoutType of this.workoutTypes">
            {{ workoutType.name }}</span>
        </div>

        <div>
          <h4>Ajouter un type d'exercice</h4>

          <input id="addWorkoutInput" name="url" [(ngModel)]="this.workoutNameInput"
            placeholder="Nouveau type d'exercice" />
        </div>
        <button mat-raised-button id="addWorkoutTypeButton" (click)="addWorkoutType()" color="primary">Valider</button>
      </div>

      <div *ngSwitchCase="widgetViewEnum.EDIT_WORKOUT_SESSION_VIEW">
        <button mat-raised-button (click)="backToWorkoutSessionsList()">Back</button>
        <app-workout-session-edit [workoutTypes]="this.workoutTypes"
          [currentWorkoutSessionToEdit]="this.currentWorkoutSessionToEdit"></app-workout-session-edit>
      </div>
    </div>
  </ng-template>
</app-widget>
